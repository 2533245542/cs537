\hypertarget{fs_8c}{\section{kernel/fs.c File Reference}
\label{fs_8c}\index{kernel/fs.\-c@{kernel/fs.\-c}}
}
{\ttfamily \#include \char`\"{}types.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}defs.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}param.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}stat.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}mmu.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}proc.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}spinlock.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}buf.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}fs.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}file.\-h\char`\"{}}\\*
Include dependency graph for fs.\-c\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{fs_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{fs_8c_ac6afabdc09a49a433ee19d8a9486056d}{min}(a, b)~((a) $<$ (b) ? (a) \-: (b))
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{fs_8c_a508e2b44186d5b3997a1564fe5a6c2d9}{iinit} (void)
\item 
struct \hyperlink{structinode}{inode} $\ast$ \hyperlink{fs_8c_adb360ce0b70a32d19d089fba4cd91293}{ialloc} (\hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint} dev, short type)
\item 
void \hyperlink{fs_8c_a7220afa8e5f4bea540eb95879ea7df6e}{iupdate} (struct \hyperlink{structinode}{inode} $\ast$ip)
\item 
struct \hyperlink{structinode}{inode} $\ast$ \hyperlink{fs_8c_a6b41577cc09b2a009be8f84bfb500079}{idup} (struct \hyperlink{structinode}{inode} $\ast$ip)
\item 
void \hyperlink{fs_8c_aed28187406d84a3aa71f10c6235a03ec}{ilock} (struct \hyperlink{structinode}{inode} $\ast$ip)
\item 
void \hyperlink{fs_8c_ae4e29916219b9293b37f9c34220694fe}{iunlock} (struct \hyperlink{structinode}{inode} $\ast$ip)
\item 
void \hyperlink{fs_8c_ab3c447f135c68e4c3c1f8d5866f6e77b}{iput} (struct \hyperlink{structinode}{inode} $\ast$ip)
\item 
void \hyperlink{fs_8c_a207b3008bae35596c55ec7c4fc6875eb}{iunlockput} (struct \hyperlink{structinode}{inode} $\ast$ip)
\item 
void \hyperlink{fs_8c_a4ccff0bd4d9802e709d0af8d71a59861}{stati} (struct \hyperlink{structinode}{inode} $\ast$ip, struct \hyperlink{structstat}{stat} $\ast$st)
\item 
int \hyperlink{fs_8c_a3aba1fa9f6789d09356aec5b96d91fa8}{readi} (struct \hyperlink{structinode}{inode} $\ast$ip, char $\ast$dst, \hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint} off, \hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint} n)
\item 
int \hyperlink{fs_8c_a15858f4d8a4cc1def3d84d03c312836b}{writei} (struct \hyperlink{structinode}{inode} $\ast$ip, char $\ast$src, \hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint} off, \hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint} n)
\item 
int \hyperlink{fs_8c_ae74f6e5b19a4e7f3e72807ee67141819}{namecmp} (const char $\ast$s, const char $\ast$t)
\item 
struct \hyperlink{structinode}{inode} $\ast$ \hyperlink{fs_8c_aa182c62fade7a0bae9408830d5e06d4f}{dirlookup} (struct \hyperlink{structinode}{inode} $\ast$dp, char $\ast$\hyperlink{usertests_8c_aee754febd402311e2a552cb0d6ab6629}{name}, \hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint} $\ast$poff)
\item 
int \hyperlink{fs_8c_a69a135a0e8a06d9f306d77ebc0c1f7a0}{dirlink} (struct \hyperlink{structinode}{inode} $\ast$dp, char $\ast$\hyperlink{usertests_8c_aee754febd402311e2a552cb0d6ab6629}{name}, \hyperlink{types_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint} inum)
\item 
struct \hyperlink{structinode}{inode} $\ast$ \hyperlink{fs_8c_a9baba030d5bc6e9e20cf8b7d181edf35}{namei} (char $\ast$path)
\item 
struct \hyperlink{structinode}{inode} $\ast$ \hyperlink{fs_8c_a5a987ca4f8ffd579b96a8b9a60e61a7c}{nameiparent} (char $\ast$path, char $\ast$\hyperlink{usertests_8c_aee754febd402311e2a552cb0d6ab6629}{name})
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\begin{tabbing}
xx\=xx\=xx\=xx\=xx\=xx\=xx\=xx\=xx\=\kill
struct \{\\
\>struct \hyperlink{structspinlock}{spinlock} \hyperlink{fs_8c_ab28e82cd5dda7d960095706a3ea20572}{lock}\\
\>struct \hyperlink{structinode}{inode} \hyperlink{fs_8c_a6baaf26dd83b71b8d684c5d54a709e31}{inode} \mbox{[}\hyperlink{param_8h_adabafa10c7951be7c875cd2ee212be85}{NINODE}\mbox{]}\\
\} \hyperlink{fs_8c_a1fbfdebf96af7ed1f992e387cba059b3}{icache}\\

\end{tabbing}\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{fs_8c_ac6afabdc09a49a433ee19d8a9486056d}{\index{fs.\-c@{fs.\-c}!min@{min}}
\index{min@{min}!fs.c@{fs.\-c}}
\subsubsection[{min}]{\setlength{\rightskip}{0pt plus 5cm}\#define min(
\begin{DoxyParamCaption}
\item[{}]{a, }
\item[{}]{b}
\end{DoxyParamCaption}
)~((a) $<$ (b) ? (a) \-: (b))}}\label{fs_8c_ac6afabdc09a49a433ee19d8a9486056d}


Definition at line 24 of file fs.\-c.



\subsection{Function Documentation}
\hypertarget{fs_8c_a69a135a0e8a06d9f306d77ebc0c1f7a0}{\index{fs.\-c@{fs.\-c}!dirlink@{dirlink}}
\index{dirlink@{dirlink}!fs.c@{fs.\-c}}
\subsubsection[{dirlink}]{\setlength{\rightskip}{0pt plus 5cm}int dirlink (
\begin{DoxyParamCaption}
\item[{struct {\bf inode} $\ast$}]{dp, }
\item[{char $\ast$}]{name, }
\item[{{\bf uint}}]{inum}
\end{DoxyParamCaption}
)}}\label{fs_8c_a69a135a0e8a06d9f306d77ebc0c1f7a0}


Definition at line 497 of file fs.\-c.

\hypertarget{fs_8c_aa182c62fade7a0bae9408830d5e06d4f}{\index{fs.\-c@{fs.\-c}!dirlookup@{dirlookup}}
\index{dirlookup@{dirlookup}!fs.c@{fs.\-c}}
\subsubsection[{dirlookup}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf inode}$\ast$ dirlookup (
\begin{DoxyParamCaption}
\item[{struct {\bf inode} $\ast$}]{dp, }
\item[{char $\ast$}]{name, }
\item[{{\bf uint} $\ast$}]{poff}
\end{DoxyParamCaption}
)}}\label{fs_8c_aa182c62fade7a0bae9408830d5e06d4f}


Definition at line 465 of file fs.\-c.

\hypertarget{fs_8c_adb360ce0b70a32d19d089fba4cd91293}{\index{fs.\-c@{fs.\-c}!ialloc@{ialloc}}
\index{ialloc@{ialloc}!fs.c@{fs.\-c}}
\subsubsection[{ialloc}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf inode}$\ast$ ialloc (
\begin{DoxyParamCaption}
\item[{{\bf uint}}]{dev, }
\item[{short}]{type}
\end{DoxyParamCaption}
)}}\label{fs_8c_adb360ce0b70a32d19d089fba4cd91293}


Definition at line 147 of file fs.\-c.

\hypertarget{fs_8c_a6b41577cc09b2a009be8f84bfb500079}{\index{fs.\-c@{fs.\-c}!idup@{idup}}
\index{idup@{idup}!fs.c@{fs.\-c}}
\subsubsection[{idup}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf inode}$\ast$ idup (
\begin{DoxyParamCaption}
\item[{struct {\bf inode} $\ast$}]{ip}
\end{DoxyParamCaption}
)}}\label{fs_8c_a6b41577cc09b2a009be8f84bfb500079}


Definition at line 227 of file fs.\-c.

\hypertarget{fs_8c_a508e2b44186d5b3997a1564fe5a6c2d9}{\index{fs.\-c@{fs.\-c}!iinit@{iinit}}
\index{iinit@{iinit}!fs.c@{fs.\-c}}
\subsubsection[{iinit}]{\setlength{\rightskip}{0pt plus 5cm}void iinit (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{fs_8c_a508e2b44186d5b3997a1564fe5a6c2d9}


Definition at line 138 of file fs.\-c.

\hypertarget{fs_8c_aed28187406d84a3aa71f10c6235a03ec}{\index{fs.\-c@{fs.\-c}!ilock@{ilock}}
\index{ilock@{ilock}!fs.c@{fs.\-c}}
\subsubsection[{ilock}]{\setlength{\rightskip}{0pt plus 5cm}void ilock (
\begin{DoxyParamCaption}
\item[{struct {\bf inode} $\ast$}]{ip}
\end{DoxyParamCaption}
)}}\label{fs_8c_aed28187406d84a3aa71f10c6235a03ec}


Definition at line 237 of file fs.\-c.

\hypertarget{fs_8c_ab3c447f135c68e4c3c1f8d5866f6e77b}{\index{fs.\-c@{fs.\-c}!iput@{iput}}
\index{iput@{iput}!fs.c@{fs.\-c}}
\subsubsection[{iput}]{\setlength{\rightskip}{0pt plus 5cm}void iput (
\begin{DoxyParamCaption}
\item[{struct {\bf inode} $\ast$}]{ip}
\end{DoxyParamCaption}
)}}\label{fs_8c_ab3c447f135c68e4c3c1f8d5866f6e77b}


Definition at line 282 of file fs.\-c.

\hypertarget{fs_8c_ae4e29916219b9293b37f9c34220694fe}{\index{fs.\-c@{fs.\-c}!iunlock@{iunlock}}
\index{iunlock@{iunlock}!fs.c@{fs.\-c}}
\subsubsection[{iunlock}]{\setlength{\rightskip}{0pt plus 5cm}void iunlock (
\begin{DoxyParamCaption}
\item[{struct {\bf inode} $\ast$}]{ip}
\end{DoxyParamCaption}
)}}\label{fs_8c_ae4e29916219b9293b37f9c34220694fe}


Definition at line 269 of file fs.\-c.

\hypertarget{fs_8c_a207b3008bae35596c55ec7c4fc6875eb}{\index{fs.\-c@{fs.\-c}!iunlockput@{iunlockput}}
\index{iunlockput@{iunlockput}!fs.c@{fs.\-c}}
\subsubsection[{iunlockput}]{\setlength{\rightskip}{0pt plus 5cm}void iunlockput (
\begin{DoxyParamCaption}
\item[{struct {\bf inode} $\ast$}]{ip}
\end{DoxyParamCaption}
)}}\label{fs_8c_a207b3008bae35596c55ec7c4fc6875eb}


Definition at line 304 of file fs.\-c.

\hypertarget{fs_8c_a7220afa8e5f4bea540eb95879ea7df6e}{\index{fs.\-c@{fs.\-c}!iupdate@{iupdate}}
\index{iupdate@{iupdate}!fs.c@{fs.\-c}}
\subsubsection[{iupdate}]{\setlength{\rightskip}{0pt plus 5cm}void iupdate (
\begin{DoxyParamCaption}
\item[{struct {\bf inode} $\ast$}]{ip}
\end{DoxyParamCaption}
)}}\label{fs_8c_a7220afa8e5f4bea540eb95879ea7df6e}


Definition at line 172 of file fs.\-c.

\hypertarget{fs_8c_ae74f6e5b19a4e7f3e72807ee67141819}{\index{fs.\-c@{fs.\-c}!namecmp@{namecmp}}
\index{namecmp@{namecmp}!fs.c@{fs.\-c}}
\subsubsection[{namecmp}]{\setlength{\rightskip}{0pt plus 5cm}int namecmp (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{s, }
\item[{const char $\ast$}]{t}
\end{DoxyParamCaption}
)}}\label{fs_8c_ae74f6e5b19a4e7f3e72807ee67141819}


Definition at line 456 of file fs.\-c.

\hypertarget{fs_8c_a9baba030d5bc6e9e20cf8b7d181edf35}{\index{fs.\-c@{fs.\-c}!namei@{namei}}
\index{namei@{namei}!fs.c@{fs.\-c}}
\subsubsection[{namei}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf inode}$\ast$ namei (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{path}
\end{DoxyParamCaption}
)}}\label{fs_8c_a9baba030d5bc6e9e20cf8b7d181edf35}


Definition at line 603 of file fs.\-c.

\hypertarget{fs_8c_a5a987ca4f8ffd579b96a8b9a60e61a7c}{\index{fs.\-c@{fs.\-c}!nameiparent@{nameiparent}}
\index{nameiparent@{nameiparent}!fs.c@{fs.\-c}}
\subsubsection[{nameiparent}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf inode}$\ast$ nameiparent (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{path, }
\item[{char $\ast$}]{name}
\end{DoxyParamCaption}
)}}\label{fs_8c_a5a987ca4f8ffd579b96a8b9a60e61a7c}


Definition at line 610 of file fs.\-c.

\hypertarget{fs_8c_a3aba1fa9f6789d09356aec5b96d91fa8}{\index{fs.\-c@{fs.\-c}!readi@{readi}}
\index{readi@{readi}!fs.c@{fs.\-c}}
\subsubsection[{readi}]{\setlength{\rightskip}{0pt plus 5cm}int readi (
\begin{DoxyParamCaption}
\item[{struct {\bf inode} $\ast$}]{ip, }
\item[{char $\ast$}]{dst, }
\item[{{\bf uint}}]{off, }
\item[{{\bf uint}}]{n}
\end{DoxyParamCaption}
)}}\label{fs_8c_a3aba1fa9f6789d09356aec5b96d91fa8}


Definition at line 395 of file fs.\-c.

\hypertarget{fs_8c_a4ccff0bd4d9802e709d0af8d71a59861}{\index{fs.\-c@{fs.\-c}!stati@{stati}}
\index{stati@{stati}!fs.c@{fs.\-c}}
\subsubsection[{stati}]{\setlength{\rightskip}{0pt plus 5cm}void stati (
\begin{DoxyParamCaption}
\item[{struct {\bf inode} $\ast$}]{ip, }
\item[{struct {\bf stat} $\ast$}]{st}
\end{DoxyParamCaption}
)}}\label{fs_8c_a4ccff0bd4d9802e709d0af8d71a59861}


Definition at line 384 of file fs.\-c.

\hypertarget{fs_8c_a15858f4d8a4cc1def3d84d03c312836b}{\index{fs.\-c@{fs.\-c}!writei@{writei}}
\index{writei@{writei}!fs.c@{fs.\-c}}
\subsubsection[{writei}]{\setlength{\rightskip}{0pt plus 5cm}int writei (
\begin{DoxyParamCaption}
\item[{struct {\bf inode} $\ast$}]{ip, }
\item[{char $\ast$}]{src, }
\item[{{\bf uint}}]{off, }
\item[{{\bf uint}}]{n}
\end{DoxyParamCaption}
)}}\label{fs_8c_a15858f4d8a4cc1def3d84d03c312836b}


Definition at line 422 of file fs.\-c.



\subsection{Variable Documentation}
\hypertarget{fs_8c_a1fbfdebf96af7ed1f992e387cba059b3}{\index{fs.\-c@{fs.\-c}!icache@{icache}}
\index{icache@{icache}!fs.c@{fs.\-c}}
\subsubsection[{icache}]{\setlength{\rightskip}{0pt plus 5cm}struct \{ ... \}   icache}}\label{fs_8c_a1fbfdebf96af7ed1f992e387cba059b3}
\hypertarget{fs_8c_a6baaf26dd83b71b8d684c5d54a709e31}{\index{fs.\-c@{fs.\-c}!inode@{inode}}
\index{inode@{inode}!fs.c@{fs.\-c}}
\subsubsection[{inode}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf inode} {\bf inode}\mbox{[}{\bf N\-I\-N\-O\-D\-E}\mbox{]}}}\label{fs_8c_a6baaf26dd83b71b8d684c5d54a709e31}


Definition at line 134 of file fs.\-c.

\hypertarget{fs_8c_ab28e82cd5dda7d960095706a3ea20572}{\index{fs.\-c@{fs.\-c}!lock@{lock}}
\index{lock@{lock}!fs.c@{fs.\-c}}
\subsubsection[{lock}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf spinlock} lock}}\label{fs_8c_ab28e82cd5dda7d960095706a3ea20572}


Definition at line 133 of file fs.\-c.

